/*! grphm 21-10-2013 */
DragDrop=function(a,b){var c=function(a){a.stopPropagation(),a.preventDefault()},d=function(a){c(a),b(a.dataTransfer.files)};a.addEventListener("dragleave",c),a.addEventListener("dragenter",c),a.addEventListener("dragover",c),a.addEventListener("drop",d)},function(){var a,b;b=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/30)}}(),window.Graphemescope=a=function(){function a(a){var c=this;this.parentElement=null!=a?a:window.document.body,this.enabled=!0,this.radiusFactor=1,this.zoomFactor=1,this.angleFactor=0,this.zoomTarget=1.2,this.angleTarget=.8,this.easeEnabled=!0,this.ease=.1,null==this.domElement&&(this.domElement=document.createElement("canvas")),null==this.ctx&&(this.ctx=this.domElement.getContext("2d")),this.alphaFactor=1,this.alphaTarget=1,this.parentElement.appendChild(this.domElement),this.oldResizeHandler=function(){},null!==window.onresize&&(this.oldResizeHandler=window.onresize),window.onresize=function(){return c.resizeHandler()},this.resizeHandler(),b(function(){return c.animationFrame()})}return a.prototype.animationFrame=function(){var a=this;return b(function(){return a.animationFrame()}),this.enabled?(this.update(),this.draw()):void 0},a.prototype.resizeHandler=function(){return this.width=this.domElement.width=this.parentElement.offsetWidth,this.height=this.domElement.height=this.parentElement.offsetHeight,this.radius=.5*this.radiusFactor*Math.min(this.width,this.height),this.radiusHeight=.5*Math.sqrt(3)*this.radius,this.oldResizeHandler()},a.prototype.update=function(){return this.easeEnabled?(this.angleFactor+=(this.angleTarget-this.angleFactor)*this.ease,this.zoomFactor+=(this.zoomTarget-this.zoomFactor)*this.ease,this.alphaFactor+=(this.alphaTarget-this.alphaFactor)*this.ease):(this.angleFactor=this.angleTarget,this.zoomFactor=this.zoomTarget,this.alphaFactor=this.alphaTarget)},a.prototype.drawImage=function(a){var b,c;return this.ctx.save(),b=2/3*this.radiusHeight,c=this.zoomFactor*b/(.5*Math.min(a.width,a.height)),this.ctx.translate(0,b),this.ctx.scale(c,c),this.ctx.rotate(2*this.angleFactor*Math.PI),this.ctx.translate(-.5*a.width,-.5*a.height),this.ctx.fill(),this.ctx.restore()},a.prototype.drawCell=function(a){var b,c,d;for(d=[],b=c=0;6>c;b=++c)this.ctx.save(),this.ctx.rotate(2*b*Math.PI/6),this.ctx.scale([-1,1][b%2],1),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(-.5*this.radius,1*this.radiusHeight),this.ctx.lineTo(.5*this.radius,1*this.radiusHeight),this.ctx.closePath(),this.drawImage(a),d.push(this.ctx.restore());return d},a.prototype.drawLayer=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(this.ctx.save(),this.ctx.translate(.5*this.width,.5*this.height),f=Math.ceil(.5*this.height/this.radiusHeight),c=Math.ceil(.5*this.width/(3*this.radius)),d=function(){l=[];for(var a=-c;c>=-c?c>=a:a>=c;c>=-c?a++:a--)l.push(a);return l}.apply(this),g=function(){m=[];for(var a=-f;f>=-f?f>=a:a>=f;f>=-f?a++:a--)m.push(a);return m}.apply(this),h=0,j=g.length;j>h;h++){for(e=g[h],this.ctx.save(),this.ctx.translate(0,this.radiusHeight*e),Math.abs(e)%2&&this.ctx.translate(1.5*this.radius,0),i=0,k=d.length;k>i;i++)b=d[i],this.ctx.save(),this.ctx.translate(3*b*this.radius,0),this.drawCell(a),this.ctx.restore();this.ctx.restore()}return this.ctx.restore()},a.prototype.draw=function(){return null!=this.imageProxy&&(this.ctx.fillStyle=this.patternProxy,this.ctx.globalAlpha=1-this.alphaFactor,this.drawLayer(this.imageProxy)),null!=this.image?(this.ctx.fillStyle=this.pattern,this.ctx.globalAlpha=this.alphaFactor,this.drawLayer(this.image)):void 0},a.prototype.setImageDirect=function(a){return null!=this.image&&(this.imageProxy=this.image,this.patternProxy=this.pattern),this.image=a,this.pattern=this.ctx.createPattern(this.image,"repeat"),this.alphaFactor=0},a.prototype.setImage=function(a){var b,c=this;return"string"==typeof a?(b=new Image,b.src=a,b.onload=function(){return c.setImageDirect(b)}):this.setImageDirect(a)},a}()}.call(this),jQuery(function(a){a(window).on("load",function(){function b(){var b=a(".promo h1"),c=a(".promo .company-desc"),d=a(".promo .sep");b.animate({opacity:"1"},1200).css({"-moz-transform":"translate(0px, 0px)","-o-transform":"translate(0px, 0px)","-webkit-transform":"translate3d(0px, 0px, 0px)","-ms-transform":"translate(0px, 0px)",transform:"translate(0px, 0px)"}),c.animate({opacity:"1"},1200).css({"-moz-transform":"translate(0px, 0px)","-o-transform":"translate(0px, 0px)","-webkit-transform":"translate3d(0px, 0px, 0px)","-ms-transform":"translate(0px, 0px)",transform:"translate(0px, 0px)"}),d.animate({opacity:"1"},1600)}function c(){var b=a(window).height(),c=a("header").height(),d=a("footer").height(),e=a("article .promo");e.height(b-(d+c))}function d(){var b=a("nav"),c=a(window);c.width()>1003&&b.attr("style")&&a("nav, .phone, .mailto").removeAttr("style")}function e(){j.setImage(g[k]),k=(k+1)%g.length,setTimeout(e,8e3)}function f(a,b){j.angleTarget=a,j.zoomTarget=1+.5*b}a(document).ready(function(){c()}),a(window).resize(function(){c(),d()}),a(".scroll, #menu-item-portfolio").click(function(){a("html, body").animate({scrollTop:a(".portfolio").offset().top},2e3)}),a(".morelink").click(function(){var b=a("nav"),c=a(".phone, .mailto");"none"==b.css("display")?b.slideToggle(800,function(){c.fadeIn(800)}):c.fadeOut(600,function(){c.removeAttr("style"),b.slideUp(600,function(){b.removeAttr("style")})})}),Typekit.load(),b();var g=a(".scope-pattern");try{var h=a(".graphemescope"),i=a(".promo"),j=new Graphemescope(h[0]),k=0;e(),new DragDrop(i[0],function(a){var b=/^image/i,c=a[0];if(b.test(c.type)){var d=new FileReader;d.onload=function(a){j.setImage(a.target.result)},d.readAsDataURL(c)}}),a(window).mousemove(function(b){f(b.pageX/a(window).width(),b.pageY/a(window).height())}),i.on("touchmove",function(b){b.preventDefault();var c=b.originalEvent,d=c.touches[0];f(d.pageX/a(window).width(),d.pageY/a(window).height())})}catch(l){}})});