/*! grphm 17-10-2013 */
(function(){var a,b;b=function(){function a(a,b,c){var d=this;this.context=a,this.audio=new Audio,this.audio.src=b,this.audio.loop=!0,this.fadeDuration=500,document.body.appendChild(this.audio),this.audio.style.display="none",this.audio.addEventListener("canplay",function(){return d.source=d.context.createMediaElementSource(d.audio),d.gainNode=d.context.createGain(),d.gainNode.gain.value=1,d.source.connect(d.gainNode),d.gainNode.connect(d.context.destination),d.paused=d.audio.paused,c()})}return a.prototype.clearTimeout=function(){return null!=this.stopTimeout?(clearTimeout(this.stopTimeout),this.stopTimeout=void 0):void 0},a.prototype.play=function(){var a;return this.clearTimeout(),this.paused=!1,this.audio.play(),a=this.context.currentTime,null!=this.gainNode?(this.gainNode.gain.linearRampToValueAtTime(0,a),this.gainNode.gain.linearRampToValueAtTime(1,a+this.fadeDuration/1e3)):void 0},a.prototype.pause=function(){var a,b=this;return this.clearTimeout(),this.paused=!0,a=this.context.currentTime,null!=this.gainNode&&(this.gainNode.gain.linearRampToValueAtTime(1,a),this.gainNode.gain.linearRampToValueAtTime(0,a+this.fadeDuration/1e3)),this.stopTimeout=setTimeout(function(){return b.audio.pause()},this.fadeDuration)},a}(),window.AudioAnalyser=a=function(){function a(b,c){var d=this;this.numBands=null!=b?b:256,this.smoothing=null!=c?c:.3,a.supported&&(this.context=new a.AudioContext,this.analyser=this.context.createAnalyser(),this.analyser.smoothingTimeConstant=this.smoothing,this.analyser.fftSize=2*this.numBands,this.bands=new Uint8Array(this.analyser.frequencyBinCount),this.jsNode=this.context.createJavaScriptNode(2048,1,1),this.analyser.connect(this.jsNode),this.jsNode.connect(this.context.destination),this.currentId=0,this.jsNode.onaudioprocess=function(){return d.analyser.getByteFrequencyData(d.bands),d.isPaused()?void 0:"function"==typeof d.onUpdate?d.onUpdate(d.bands):void 0})}return a.AudioContext=self.AudioContext||self.webkitAudioContext,a.supported=null!=a.AudioContext,a.prototype.isPaused=function(){return null==this.track?!0:this.track.paused},a.prototype.setAudio=function(a){var c,d,e,f=this;return null!=(e=this.track)&&e.pause(),++this.currentId,d=this.currentId,c=new b(this.context,a,function(){return f.currentId===d?(f.track=c,f.track.gainNode.connect(f.analyser),f.play()):void 0})},a.prototype.play=function(){var a;return null!=(a=this.track)?a.play():void 0},a.prototype.pause=function(){var a;return null!=(a=this.track)?a.pause():void 0},a}()}).call(this),function(){var a;window.DragDrop=a=function(){function a(a,b){var c,d=this;this.context=a,this.onDrop=b,c=function(a){return a.stopPropagation(),a.preventDefault()},this.context.addEventListener("dragleave",function(a){return c(a),"function"==typeof d.onLeave?d.onLeave(a):void 0}),this.context.addEventListener("dragenter",function(a){return c(a),"function"==typeof d.onEnter?d.onEnter(a):void 0}),this.context.addEventListener("dragover",function(a){return c(a),"function"==typeof d.onOver?d.onOver(a):void 0}),this.context.addEventListener("drop",function(a){return c(a),"function"==typeof d.onDrop?d.onDrop(a.dataTransfer.files):void 0})}return a}()}.call(this),function(){var a,b;b=function(){function a(){}return a.prototype.process=function(a){return(null==this.maxValue||a>this.maxValue)&&(this.maxValue=a),0!==this.maxValue&&(a/=this.maxValue),a},a}(),window.Graphemescope=a=function(){function a(a){var c=this;this.container=a,this.kaleidoscope=new Kaleidoscope(this.container),AudioAnalyser.supported&&(this.analyser=new AudioAnalyser(256,.5),this.primarySignal=new b,this.secondarySignal=new b,this.analyser.onUpdate=function(a){return c.analyzeCallback(a)})}return a.prototype.setImage=function(a){var b,c=this;return"string"==typeof a?(b=new Image,b.src=a,b.onload=function(){return c.kaleidoscope.setImage(b)}):this.kaleidoscope.setImage(a)},a.prototype.setAudio=function(a){return AudioAnalyser.supported?this.analyser.setAudio(a):void 0},a.prototype.analyzeCallback=function(a){var b,c,d,e,f;for(c=d=0,b=e=128;256>e;b=++e)c+=a[b]/256;for(c/=128,b=f=0;128>f;b=++f)d+=a[b]/256;return d/=128,this.kaleidoscope.zoomTarget=1+1*c,this.kaleidoscope.angleTarget=-.5+.5*d},a}()}.call(this),function(){var a,b;b=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/30)}}(),window.Kaleidoscope=a=function(){function a(a){var c=this;this.parentElement=null!=a?a:window.document.body,this.enabled=!0,this.radiusFactor=1,this.zoomFactor=1,this.angleFactor=0,this.zoomTarget=1.2,this.angleTarget=.8,this.easeEnabled=!0,this.ease=.1,null==this.domElement&&(this.domElement=document.createElement("canvas")),null==this.ctx&&(this.ctx=this.domElement.getContext("2d")),this.alphaFactor=1,this.alphaTarget=1,this.parentElement.appendChild(this.domElement),this.oldResizeHandler=function(){},null!==window.onresize&&(this.oldResizeHandler=window.onresize),window.onresize=function(){return c.resizeHandler()},this.resizeHandler(),b(function(){return c.animationFrame()})}return a.prototype.animationFrame=function(){var a=this;return b(function(){return a.animationFrame()}),this.enabled?(this.update(),this.draw()):void 0},a.prototype.resizeHandler=function(){return this.width=this.domElement.width=this.parentElement.offsetWidth,this.height=this.domElement.height=this.parentElement.offsetHeight,this.radius=.5*this.radiusFactor*Math.min(this.width,this.height),this.radiusHeight=.5*Math.sqrt(3)*this.radius,this.oldResizeHandler()},a.prototype.update=function(){return this.easeEnabled?(this.angleFactor+=(this.angleTarget-this.angleFactor)*this.ease,this.zoomFactor+=(this.zoomTarget-this.zoomFactor)*this.ease,this.alphaFactor+=(this.alphaTarget-this.alphaFactor)*this.ease):(this.angleFactor=this.angleTarget,this.zoomFactor=this.zoomTarget,this.alphaFactor=this.alphaTarget)},a.prototype.drawImage=function(a){var b;return this.ctx.save(),b=this.zoomFactor*this.radius/Math.min(a.width,a.height),this.ctx.translate(0,2/3*this.radiusHeight),this.ctx.scale(b,b),this.ctx.rotate(2*this.angleFactor*Math.PI),this.ctx.translate(-.5*a.width,-.5*a.height),this.ctx.fill(),this.ctx.restore()},a.prototype.drawCell=function(a){var b,c,d;for(d=[],b=c=0;6>c;b=++c)this.ctx.save(),this.ctx.rotate(2*b*Math.PI/6),this.ctx.scale([-1,1][b%2],1),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(-.5*this.radius,1*this.radiusHeight),this.ctx.lineTo(.5*this.radius,1*this.radiusHeight),this.ctx.closePath(),this.drawImage(a),d.push(this.ctx.restore());return d},a.prototype.drawLayer=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(this.ctx.save(),this.ctx.translate(.5*this.width,.5*this.height),f=Math.ceil(.5*this.height/this.radiusHeight),c=Math.ceil(.5*this.width/(3*this.radius)),d=function(){l=[];for(var a=-c;c>=-c?c>=a:a>=c;c>=-c?a++:a--)l.push(a);return l}.apply(this),g=function(){m=[];for(var a=-f;f>=-f?f>=a:a>=f;f>=-f?a++:a--)m.push(a);return m}.apply(this),h=0,j=g.length;j>h;h++){for(e=g[h],this.ctx.save(),this.ctx.translate(0,this.radiusHeight*e),Math.abs(e)%2&&this.ctx.translate(1.5*this.radius,0),i=0,k=d.length;k>i;i++)b=d[i],this.ctx.save(),this.ctx.translate(3*b*this.radius,0),this.drawCell(a),this.ctx.restore();this.ctx.restore()}return this.ctx.restore()},a.prototype.draw=function(){return null!=this.imageProxy&&(this.ctx.fillStyle=this.patternProxy,this.ctx.globalAlpha=1-this.alphaFactor,this.drawLayer(this.imageProxy)),null!=this.image?(this.ctx.fillStyle=this.pattern,this.ctx.globalAlpha=this.alphaFactor,this.drawLayer(this.image)):void 0},a.prototype.setImage=function(a){return null!=this.image&&(this.imageProxy=this.image,this.patternProxy=this.pattern),this.image=a,this.pattern=this.ctx.createPattern(this.image,"repeat"),this.alphaFactor=0},a}()}.call(this),jQuery(function(a){a(window).on("load",function(){function b(){var b=a(".promo h1"),c=a(".promo .company-desc"),d=a(".promo .sep");b.animate({opacity:"1"},1200).css({"-moz-transform":"translate(0px, 0px)","-o-transform":"translate(0px, 0px)","-webkit-transform":"translate3d(0px, 0px, 0px)","-ms-transform":"translate(0px, 0px)",transform:"translate(0px, 0px)"}),c.animate({opacity:"1"},1200).css({"-moz-transform":"translate(0px, 0px)","-o-transform":"translate(0px, 0px)","-webkit-transform":"translate3d(0px, 0px, 0px)","-ms-transform":"translate(0px, 0px)",transform:"translate(0px, 0px)"}),d.animate({opacity:"1"},1600)}function c(){var b=a(window).height(),c=a("header").height(),d=a("footer").height(),e=a("article .promo");e.height(b-(d+c))}function d(){var b=a("nav"),c=a(window);c.width()>1003&&b.attr("style")&&a("nav, .phone, .mailto").removeAttr("style")}function e(){j.setImage(g[k]),k=(k+1)%g.length,setTimeout(e,8e3)}function f(a,b){j.kaleidoscope.angleTarget=a,j.kaleidoscope.zoomTarget=1+.5*b}a(document).ready(function(){c()}),a(window).resize(function(){c(),d()}),a(".scroll, #menu-item-portfolio").click(function(){a("html, body").animate({scrollTop:a(".portfolio").offset().top},2e3)}),a(".morelink").click(function(){var b=a("nav"),c=a(".phone, .mailto");"none"==b.css("display")?b.slideToggle(800,function(){c.fadeIn(800)}):c.fadeOut(600,function(){c.removeAttr("style"),b.slideUp(600,function(){b.removeAttr("style")})})}),Typekit.load(),b();var g=["http://media-cache-ec0.pinimg.com/736x/ba/30/13/ba3013a07ff3508095064edc2e0829a0.jpg","http://media-cache-ec0.pinimg.com/236x/6f/77/57/6f7757a20914c650ecbd3c61b7b3d68e.jpg","http://media-cache-ec0.pinimg.com/736x/aa/1e/7f/aa1e7f7313191a261525056e58a937e6.jpg"];try{var h=a(".graphemescope"),i=a(".promo"),j=new Graphemescope(h[0]),k=0;e(),new DragDrop(i[0],function(a){var b=/^image/i,c=a[0];if(b.test(c.type)){var d=new FileReader;d.onload=function(a){j.setImage(a.target.result)},d.readAsDataURL(c)}}),a(window).mousemove(function(b){f(b.pageX/a(window).width(),b.pageY/a(window).height())}),i.on("touchmove",function(b){b.preventDefault();var c=b.originalEvent,d=c.touches[0];f(d.pageX/a(window).width(),d.pageY/a(window).height())})}catch(l){}})});